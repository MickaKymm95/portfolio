---
import { getCollection } from 'astro:content';
import { CldImage } from 'astro-cloudinary'; // Pour l'affichage optimisé

// Récupérer toutes les photos triées par date
const allPhotos = (await getCollection('portfolio')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<html lang="fr" class="bg-[#0f0f0f] text-gray-200">
  <body class="min-h-screen">

    <nav class="fixed top-0 w-full z-50 px-6 py-4 bg-black/40 backdrop-blur-md border-b border-white/5">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <h1 class="text-xl font-bold tracking-widest uppercase">Mon Portfolio</h1>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 pt-24 pb-10">
      <div class="columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6">

        {allPhotos.map((photo) => (
          <article class="break-inside-avoid group relative rounded-xl overflow-hidden shadow-2xl bg-white/5 border border-white/10 transition-transform duration-500 hover:-translate-y-2">

            <div class="aspect-auto w-full overflow-hidden">
               <img 
                 src={photo.data.heroImage} 
                 alt={photo.data.title}
                 class="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"
                 loading="lazy"
               />
            </div>

            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
              <h2 class="text-white text-lg font-bold translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                {photo.data.title}
              </h2>
              <span class="text-sm text-gray-300 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-75">
                {photo.data.category}
              </span>
            </div>
          </article>
        ))}

      </div>
    </main>

  </body>
</html>